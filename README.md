# Игра FLAPPYBIRD, суть игры - контролировать полёт птицы между рядами препятствий с помощь нажатия на кнопку.
Игра работает используя микрокнтроллер STM32F411 и светодиодную матрицу P10(32х16). Проект уже настроен и создан, необходимо только проделать шаги ниже.
1. Для запуска необходимо перенести две папки .metadata и lab5 в любую новую папку, например назовём её PROJECT.
2. В папке PROJECT переходим в папку lab5, для игры необходимо два основынх файла .cproject (Файл "CPROJECT") и lab5.ioc (STM32CubeMX).
3. Открыв файл lab5.ioc (STM32CubeMX) можно ознакомиться с настройками SPI1, TIM1 и распиновкой проекта.
4. Открыв файл .cproject (Файл "CPROJECT"), необходимо указать в WORKSPACE путь к папке PROJECT, в которой лежат наши две папки .metadata и lab5. После нажать 
   Launch и откроется сам проект, для запуска необходимо нажать Play(Зелёная треугольная кнопка вверху).
5. Для подключения матрицы и микроконтроллера необходимо ознакомиться с распиновкой в lab5.ioc (STM32CubeMX) и документацией на матрицу P10.
Ссылка на видео с игрой: https://disk.yandex.ru/i/mq95ybw6XNFtxA

# Изучение SPI
SPI (Serial Peripheral Interface) - это стандарт передачи данных в режиме полного дуплекса, который работает синхронно и разработан для обеспечения простого и доступного высокоскоростного взаимодействия между микроконтроллерами и периферийными устройствами.

Существует несколько видов реализаций SPI:
- **Полный дуплекс:** Обмен данных осуществляется в обоих направлениях одновременно.
- **Полудуплекс:** Данные могут передаваться в обоих направлениях, но не одновременно.
- **Трехпроводной режим:** Используется только MOSI, MISO и SCLK без использования линии SS.

Практически все отладочные платы из серии STM32 имеют возможность использовать этот способ передачи данных.

Для установки соединения необходимо использовать четыре провода для передачи данных. Названия этих проводов часто вызывают вопросы, но есть таблица основных вариантов их обозначений, которая приведена ниже для облегчения понимания.

![image](https://github.com/GreyRaccoon159/Flappy_Bird/assets/152299663/3b039fbb-b2ba-4d67-b678-f7371cfc2476)


Наименование пинов:
- MOSI — выход от главного устройства, вход у подчиненного (Master Out Slave In). Передача данных от главного к подчиненному.
- MISO — вход у главного устройства, выход у подчиненного (Master In Slave Out). Передача данных от подчиненного к главному.
- SCLK или SCK— последовательный тактовый сигнал (Serial Clock). Тактовый сигнал для подчиненных устройств.
- CS или SS — выбор микросхемы, выбор подчиненного (Chip Select, Slave Select).
  
# О процессе передачи данных
  
Сам процесс передачи осуществляется последовательно, формируя пакеты по 1 байту (8 бит). Иногда объем уменьшается до 4 бит.

Общий принцип передачи данных показан на следующем рисунке

![image](https://github.com/GreyRaccoon159/Flappy_Bird/assets/152299663/2697efaa-88bc-4480-ac85-b457b9d63f5b)

Передаваемые данные размещаются в сдвиговых регистрах устройств. Главное устройство генерирует импульсы синхронизации на линии SCLK, обеспечивая обмен данными. Передача данных происходит бит за битом от главного по MOSI и от подчиненного по MISO. Передача обычно начинается со старших битов, но порядок может меняться программно. После каждого пакета данных главное устройство может перевести линию SS в высокое состояние для синхронизации подчиненного устройства.

## Плюсы и минусы SPI

### Плюсы:
- **Высокая скорость передачи**
- **Простота реализации**
- **Дуплексная передача**

### Минусы:
- **Отсутствие контроля потока данных**
- **Ограничения в количестве подключаемых устройств**
- **Отсутствие обратной связи**

# Устройство LEDP10
Панель имеет размер 32x16 светодиодов, работает от 5 вольт постоянного тока, потребляет до 4 ампер и имеет максимальную мощность 20 Ватт.

Внешний вид панели изображен на следующих изображениях.

![image](https://github.com/GreyRaccoon159/Flappy_Bird/assets/152299663/ff2f5745-aeb6-46fe-8891-1f992e4c7615)

Вверху - включено, внизу - выключено.

Основные элементы панели описаны ниже.

Изображение обратной стороны панели:

![image](https://github.com/GreyRaccoon159/Flappy_Bird/assets/152299663/f44ba25d-da5f-42ae-8664-b8c8c9a650c3)

Здесь обозначены различные узлы системы.

Для подключения к светодиодной матрице и плата STM32 используют специальный кабель, разъемы которого имеют следующие функции.

![image](https://github.com/GreyRaccoon159/Flappy_Bird/assets/152299663/61fd1cc0-15bc-46f3-b9d4-764ab96bb972)

Пин A и B - переключение между строками, OE - запуск/выключение матрицы, SCK - синхронизация частоты, MOSI - передача данных, SCLK - подтверждение конца загрузки данных.

Если матрица не работает или есть артефакты, попробуйте подключить пины зеркально, так как один из кабелей может изменить распиновку.

